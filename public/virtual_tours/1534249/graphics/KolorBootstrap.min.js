var krpano=null;var debug=false;var krpanoLoaded=false;var pluginLoaded=new ktools.Map();var isTourStarted=false;var kolorFullscreen=null;var kolorBrowserDetect=null;var kolorStartIndex=4000;var crossDomainTargetUrl="";var tourLanguage;if(debug){if(typeof(console)=="undefined"){console={log:function(a){}}}}jQuery(document).ready(function(){kolorBrowserDetect=new ktools.BrowserDetect();kolorBrowserDetect.init();kolorFullscreen=new ktools.Fullscreen(document.getElementById("tourDIV"));kolorFullscreen.supportsFullscreen();kolorFullscreen.setExternal({enter:krPanoFullscreenEnter,exit:krPanoFullscreenExit,change:krpanoFullscreenChange,resize:krPanoFullscreenResize})});function krPanoFullscreenEnter(){getKrPanoInstance().call("enterFullScreenFallback")}function krPanoFullscreenExit(){getKrPanoInstance().call("exitFullScreenFallback")}function krpanoFullscreenChange(a){if(a){getKrPanoInstance().call("enterFullScreenChangeEvent")}else{getKrPanoInstance().call("exitFullScreenChangeEvent")}}function krPanoFullscreenResize(){getKrPanoInstance().call("resizeFullScreenEvent")}function setFullscreen(b){var a;if(typeof b=="string"){a=(b.toLowerCase()=="true")}else{a=Boolean(b)}if(kolorFullscreen){if(a){kolorFullscreen.request()}else{kolorFullscreen.exit()}}}function getKrPanoInstance(){if(krpano==null){krpano=document.getElementById("krpanoSWFObject")}return krpano}function invokeKrFunction(e){var a=[].slice.call(arguments,1);var d=e+"(";for(var b=0,c=a.length;b<c;b++){d+=a[b];if(b!=c-1){d+=", "}}d+=");";if(getKrPanoInstance()!==null){getKrPanoInstance().call(d)}}function getKrValue(a,b){if(typeof a=="undefined"){return a}if(getKrPanoInstance()!==null){if(getKrPanoInstance().get(a)==null){return null}switch(b){case"int":return parseInt(getKrPanoInstance().get(a));case"float":return parseFloat(getKrPanoInstance().get(a));case"string":return String(getKrPanoInstance().get(a));case"bool":return Boolean(getKrPanoInstance().get(a)==="true"||parseInt(getKrPanoInstance().get(a))===1||getKrPanoInstance().get(a)==="yes"||getKrPanoInstance().get(a)==="on");default:return getKrPanoInstance().get(a)}}else{return null}}function invokePluginFunction(e,d){if(debug){console.log("invokePluginFunction("+e+", "+d+")")}var c=ktools.KolorPluginList.getInstance().getPlugin(e);if(c==null){if(debug){console.log("invokePluginFunction: plugin instance doesn't exist")}if(pluginLoaded&&pluginLoaded.item(e)){pluginLoaded.update(e,arguments)}else{pluginLoaded.add(e,arguments)}return false}var b=c.getRegistered();if(b==null){if(debug){console.log("invokePluginFunction: plugin isn't registered")}if(pluginLoaded&&pluginLoaded.item(e)){pluginLoaded.update(e,arguments)}else{pluginLoaded.add(e,arguments)}return false}var a=[].slice.call(arguments,2);return b[d](a)}function eventKrpanoLoaded(a){if(debug){console.log("krpano is loaded")}if(krpanoLoaded){return false}tourLanguage=getKrValue("tour_language","string");if(typeof tourLanguage=="undefined"){tourLanguage="fr"}ktools.I18N.getInstance().initLanguage(tourLanguage,crossDomainTargetUrl+"Vanadesdata/Vanades_messages_",".xml");krpanoLoaded=true;if(a){}else{addKolorBox("socialShare")}}function eventUnloadPlugins(){resetValuesForPlugins();deleteKolorBox("socialShare")}function resetValuesForPlugins(){krpano=null;krpanoLoaded=false;isTourStarted=false;pluginLoaded=new ktools.Map();kolorStartIndex=4000}function eventTourStarted(){if(debug){console.log("tour is started")}isTourStarted=true}function eventTourChangeLanguage(a){if(debug){console.log("change tour language : "+a)}ktools.I18N.getInstance().initLanguage(a,crossDomainTargetUrl+"Vanadesdata/Vanades_messages_",".xml")}function addKolorBox(b){if(typeof ktools.KolorPluginList.getInstance().getPlugin(b)=="undefined"){var c=new ktools.CssStyle("KolorBoxCSS",crossDomainTargetUrl+"Vanadesdata/graphics/KolorBox/kolorBox.css");var d=new ktools.Script("KolorBoxJS",crossDomainTargetUrl+"Vanadesdata/graphics/KolorBox/KolorBox.min.js",[],true);var a=new ktools.KolorPlugin(b);a.addScript(d);a.addCss(c);ktools.KolorPluginList.getInstance().addPlugin(a.getPluginName(),a,true);showKolorBox(b,0,true)}}function showKolorBox(f,m,g){if(debug){console.log("showKolorBox "+f)}if(!ktools.KolorPluginList.getInstance().getPlugin(f).isInitialized()||typeof KolorBox==="undefined"){err="KolorBox JS or XML is not loaded !";if(debug){console.log(err)}setTimeout(function(){showKolorBox(f,m,g)},100);return}if(ktools.KolorPluginList.getInstance().getPlugin(f).getRegistered()===null){ktools.KolorPluginList.getInstance().getPlugin(f).register(new KolorBox(f,"panoDIV"))}var d=ktools.KolorPluginList.getInstance().getPlugin(f).getRegistered();if(!d.isReady()){var l=[];var a="";var n="";var b=parseInt(getKrPanoInstance().get("ptplugin["+f+"].settings[0].option.count"));for(var e=0;e<b;e++){a=getKrValue("ptplugin["+f+"].settings[0].option["+e+"].name","string");if(a=="zorder"){n=kolorStartIndex+getKrValue("ptplugin["+f+"].settings[0].option["+e+"].value",getKrValue("ptplugin["+f+"].settings[0].option["+e+"].type","string"))}else{n=getKrValue("ptplugin["+f+"].settings[0].option["+e+"].value",getKrValue("ptplugin["+f+"].settings[0].option["+e+"].type","string"))}l[a]=n}l.device=getKrValue("vrtourdevice","string");d.setKolorBoxOptions(l);if(l.starts_opened){g=false}var i=null;var h=parseInt(getKrPanoInstance().get("ptplugin["+f+"].internaldata[0].item.count"));for(var c=0;c<h;c++){i=new KolorBoxObject();i.setName(getKrValue("ptplugin["+f+"].internaldata[0].item["+c+"].name","string"));i.setTitle(getKrValue("ptplugin["+f+"].internaldata[0].item["+c+"].title","string"));i.setCaption(getKrValue("ptplugin["+f+"].internaldata[0].item["+c+"].caption","string"));i.setValue(getKrValue("ptplugin["+f+"].internaldata[0].item["+c+"].value","string"));if(i.getValue()==="externalData"){i.setData(getKrValue("data["+getKrValue("ptplugin["+f+"].internaldata[0].item["+c+"].dataName","string")+"].content","string"))}d.addKolorBoxItem(i);i.init()}d.setReady(true);invokeKrFunction("kolorBoxJsReady_"+f)}if(typeof f!=="undefined"&&(typeof g==="undefined"||g===false)){if(typeof m==="undefined"){m=0}d.openKolorBox(m)}if(pluginLoaded&&pluginLoaded.item(f)){invokePluginFunction.apply(null,pluginLoaded.item(f));pluginLoaded.remove(f)}}function deleteKolorBox(a){if(ktools.KolorPluginList.getInstance().getPlugin(a)){ktools.KolorPluginList.getInstance().removePlugin(a)}var b=document.getElementById("panoDIV");var c=document.getElementById(a);if(b&&c){b.removeChild(c)}};