var krpanoplugin=function(){function ai(b){return"boolean"==typeof b?b:0<="yesontrue1".indexOf(String(b).toLowerCase())}function f(b){if(b&&aV&&az){var g=aV.timertick,d=0;0==ah&&(ah=g);var e=g-ah|0;ah=g;"wheel"==b.type?d=b.deltaY:"mousewheel"==b.type?d=-b.wheelDelta:"DOMMouseScroll"==b.type&&(d=b.detail);d=-d;500<e?ag=1==b.deltaMode||0==d%20?0:1:66>e&&0==ag&&0!=d%40&&6<Math.abs(d)&&(ag=1);b.preventDefault();b.stopPropagation();0!=d&&(0==ag?d=0>d?-5:5:(d/=20,-10>d?d=-10:10<d&&(d=10)),1==aY?af(d*ay,0):2==aY?af(0,d*aJ):3==aY&&af(0,d*aJ))}}function aP(k,q,l,m,g){var p=null;g=(!0===g?"remove":"add")+"EventListener";var n=ae.browser.events;if(n.touch&&("down"==q?p=n.touchstart:"move"==q?p=n.touchmove:"up"==q&&(p=n.touchend),ae.ie&&0==n.mouse&&("over"==q?p=n.pointerover?n.pointerover:"MSPointerOver":"out"==q&&(p=n.pointerout?n.pointerout:"MSPointerOut")),p)){k[g](p,l,m)}if(n.mouse&&("down"==q?p="mousedown":"move"==q?p="mousemove":"up"==q?p="mouseup":"over"==q?p="mouseover":"out"==q&&(p="mouseout"),p)){k[g](p,l,m)}}function aG(){if(a2){var b=a2.sprite.parentNode;b&&(b=b.kobject)&&(b.maskchildren=!0,b.poschanged&&b.updatepluginpos(),a3=b,aS=b.pixelwidth,aR=b.pixelheight,isNaN(aS)&&(aS=0),isNaN(aR)&&(aR=0),av=0<aS||0<aR)}}function ar(){a1=Number(a2.x);a0=Number(a2.y);isNaN(aF)&&(a1=0);isNaN(aA)&&(a0=0)}function aq(b){b=void 0===b?!1:b;1==(aY&1)?a2.x!=a1&&(a2.x=a1,b=!0):a1=0;2==(aY&2)?a2.y!=a0&&(a2.y=a0,b=!0):a0=0;!av||ad[0]==aO&&ad[1]==aM||(ad[0]=aO,ad[1]=aM,b=!0);if(b&&a2&&av){b=aS-aO;var g=aR-aM,d=a1,e=a0;isNaN(d)&&(d=0);isNaN(e)&&(e=0);d+=b*aU;e+=g*aT;a2.woverflow=-b;a2.hoverflow=-g;a2.loverflow=Math.round((-d+au*b)*ay);a2.roverflow=Math.round((+d-(1-au)*b)*ay);a2.toverflow=Math.round((-e+at*g)*aJ);a2.boverflow=Math.round((+e-(1-at)*g)*aJ);a2.onscroll&&aV.call(a2.onscroll,a2)}}function aB(b){for(;0<aH.length&&!(100>=b-aH[0].time);){aH.shift()}}function ap(){aG();var b=String(a2.align).toLowerCase();if(""==b||"null"==b){b="lefttop"}aJ=ay=1;aT=aU=0.5;at=au=0;0<=b.indexOf("left")&&(aU=au=0,ay=1);0<=b.indexOf("top")&&(aT=at=0,aJ=1);0<=b.indexOf("right")&&(au=1,aU=0,ay=-1);0<=b.indexOf("bottom")&&(at=1,aT=0,aJ=-1)}function c(e){ap();aH=[];if(0==ao){aK=!1}else{aP(window,"up",aI,!0);aP(window,"move",aC,!0);var g=aV.stagescale,d=e.changedTouches&&0<e.changedTouches.length?e.changedTouches[0]:e;e=d.pageX/g;g=d.pageY/g;aK=!1;ab=e;o=g;return !1}}function i(b){(void 0===b.pointerType||4==b.pointerType||"mouse"==b.pointerType)&&a&&(ap(),0!=av&&(b=aR-aM,0>aS-aO||0>b))&&(an=!0,aP(a2.sprite,"move",aL,!0),aP(a2.sprite,"out",aD,!0))}function aL(b){an&&0==aK&&a3&&(b=a3.getmouse(),j(b.x/aS*a2.pixelwidth,b.y/aR*a2.pixelheight,!0))}function aD(b){aP(a2.sprite,"move",aL,!0,!0);aP(a2.sprite,"out",aD,!0,!0);an=!1}function aC(e){if(0==ao){return aK=!1}var k=aV.stagescale,d=e.changedTouches&&0<e.changedTouches.length?e.changedTouches[0]:e,g=d.pageX/k,k=d.pageY/k;0==aK&&(aY&1&&5<Math.abs(g-ab)||aY&2&&5<Math.abs(k-o))&&(ax&&(aZ=aX=0,ax=!1),null!=aW&&(clearInterval(aW),aW=null),aK=!0,an=!1,ab=g,o=k,ar(),aF=a1,aA=a0);aK&&(e=e.timeStamp,aB(e),aH.push({time:e,x:g,y:k}),a1=aF+(g-ab)*ay,a0=aA+(k-o)*aJ,g=-(aO-aS),e=-(aM-aR),a1+=g*aU,a0+=e*aT,k=1/(1+aw*aw),a1=0<g?a1-(a1-g*aU)*k:a1-(0<a1?a1:a1<g?a1-g:0)*k,a0=0<e?a0-(a0-e*aT)*k:a0-(0<a0?a0:a0<e?a0-e:0)*k,a1-=g*aU,a0-=e*aT,aq());return !1}function aI(e){aP(window,"up",aI,!0,!0);aP(window,"move",aC,!0,!0);if(0==ao){aZ=aX=0,aK=!1}else{if(aK){aB(e.timeStamp);if(1<aH.length){e=aH[0];var k=aH[aH.length-1],d=k.y-e.y,g=(k.time-e.time)*h;aX=(k.x-e.x)/g*ay;aZ=d/g*aJ}else{aZ=aX=0}aW=setInterval(am,1000/60);aK=!1}}}function aE(){setTimeout(function(){aG();aq(!0);null==aW&&(aW=setInterval(am,1000/60))},100)}function am(){a1+=aX;a0+=aZ;aX*=al;aZ*=al;var e=0,k=0,d=-(aO-aS),g=-(aM-aR);a1+=d*aU;a0+=g*aT;0<d?e=a1-d*aU:ax?e=a1-s:a1<d?e=a1-d:0<a1&&(e=a1);0.1>e*e&&(e=0);0<g?k=a0-g*aT:ax?k=a0-aN:a0<g?k=a0-g:0<a0&&(k=a0);0.1>k*k&&(k=0);a1-=d*aU;a0-=g*aT;0==(aY&1)&&(aX=e=0);0==(aY&2)&&(aZ=k=0);0!=e&&(e*=-1,a1+=e*(1-aw),aX=0>=e*aX?aX+e*ak:e*aj,aX*=aw);0!=k&&(k*=-1,a0+=k*(1-aw),aZ=0>=k*aZ?aZ+k*ak:k*aj,aZ*=aw);0==e&&0==k&&0.05>Math.sqrt(aX*aX+aZ*aZ)&&(ax=!1,aZ=aX=0,clearInterval(aW),aW=null);aq()}function j(e,m,d){ap();ar();if(0==av){setTimeout(function(){j(e,m,d)},10)}else{e=Number(e);isNaN(e)&&(e=0);m=Number(m);isNaN(m)&&(m=0);var l=aS-aO,k=aR-aM;e=au*aO+e*ay;m=at*aM+m*aJ;e*=-1;m*=-1;e+=aS/2;0<e&&(e=0);e<l&&(e=l);m+=aR/2;0<m&&(m=0);m<k&&(m=k);!0===d?(ax=!0,s=e,aN=m,null==aW&&(aW=setInterval(am,1000/60))):(l=-(aO-aS),k=-(aM-aR),e=0>l?e-l*aU:0,m=0>k?m-k*aT:0,a1=e,a0=m,aq())}}function ac(b,d){j(b,d,!0)}function aQ(){null!=aW&&(clearInterval(aW),aW=null);an=aK=!1;aH=[];aZ=aX=0;ax=!1;ar()}function af(e,m){ax=!1;e=Number(e);isNaN(e)&&(e=0);m=Number(m);isNaN(m)&&(m=0);ap();ar();if(0!=av){var d=aS-aO,l=aR-aM,g=!1;0>d&&(a1+=d*aU,0<e&&0>a1?(g=!0,aX+=e):0>e&&a1>d&&(g=!0,aX+=e),a1-=d*aU);0>l&&(a0+=l*aT,0<m&&0>a0?(g=!0,aZ+=m):0>m&&a0>l&&(g=!0,aZ+=m),a0-=l*aT);g&&null==aW&&(aW=setInterval(am,1000/60))}}var aV=null,a2=null,ae=null,aY=3,aO=0,aM=0,ad=[0,0],av=!1,a3=null,aS=0,aR=0,ax=!1,s=0,aN=0,ay=1,aJ=1,aU=0,aT=0,au=0,at=0,aw=1,al=0.95,ak=0.08,aj=0.15,h=1/15,ao=!0,az=!0,aK=!1,ab=0,o=0,a1=0,a0=0,aF=0,aA=0,aW=null,aH=[],aX=0,aZ=0,an=!1,a=!1;this.registerplugin=function(b,g,e){aV=b;a2=e;"1.18">aV.version?(aV.trace(3,"Scrollarea Plugin - too old krpano version (min. version 1.18)"),a2=aV=null):(ae=aV.device,a2.registerattribute("direction","all",function(d){d=String(d).toLowerCase();aY=0;aY|=1*(0<=d.indexOf("h"));aY|=2*(0<=d.indexOf("v"));aY|=3*(0<=d.indexOf("all"))},function(){return 3==(aY&3)?"all":1==(aY&1)?"h":"v"}),a2.registerattribute("overscroll",aw,function(d){aw=0>d?0:1<d?1:d},function(){return aw}),a2.registerattribute("friction",al,function(d){al=Number(d)},function(){return al}),a2.registerattribute("acceleration",ak,function(d){ak=Number(d)},function(){return ak}),a2.registerattribute("returnacceleration",aj,function(d){aj=Number(d)},function(){return aj}),a2.registerattribute("momentum",h,function(d){h=Number(d)},function(){return h}),a2.registerattribute("onscroll",null),a2.registerattribute("woverflow",0),a2.registerattribute("hoverflow",0),a2.registerattribute("loverflow",0),a2.registerattribute("roverflow",0),a2.registerattribute("toverflow",0),a2.registerattribute("boverflow",0),a2.registerattribute("draggable",!0,function(d){ao=ai(d)},function(){return ao}),a2.registerattribute("mwheel",!0,function(d){az=ai(d)},function(){return az}),a2.registerattribute("onhover_autoscrolling",!1,function(d){a=ai(d)},function(){return a}),a2.registerattribute("csshardwareacceleration","auto"),a2.setcenter=j,a2.scrolltocenter=ac,a2.stopscrolling=aQ,a2.scrollby=af,1==ai(a2.csshardwareacceleration)&&(a2.sprite.style[ae.browser.css.transform+"Style"]="preserve-3d"),a2.sprite.addEventListener("DOMMouseScroll",f,!0),a2.sprite.addEventListener("mousewheel",f,!0),a2.sprite.addEventListener("wheel",f,!0),aP(a2.sprite,"down",c,!0),aP(a2.sprite,"over",i,!0),aV.set("events["+a2.name+"_scrollarea].keep",!0),aV.set("events["+a2.name+"_scrollarea].onresize",aE))};var ah=0,ag=0;this.onresize=function(e,m){if(!aV){return !1}aO=e;aM=m;var d;ax=!1;ap();ar();if(0==av){d=!1}else{d=aS-aO;var l=aR-aM,k=!1;a1+=d*aU;if(0>d){if(0>a1||a1>d){k=!0}}else{0!=a1&&(k=!0)}a1-=d*aU;a0+=l*aT;if(0>l){if(0>a0||a0>l){k=!0}}else{0!=a0&&(k=!0)}a0-=l*aT;k&&null==aW&&(aW=setInterval(am,1000/60));d=k}0==d&&aq(!0);return !1};this.unloadplugin=function(){aV&&a2&&(aV.set("events["+a2.name+"_scrollarea].name",null),null!=aW&&(clearInterval(aW),aW=null),aP(a2.sprite,"down",c,!0,!0),aP(a2.sprite,"over",i,!0,!0));aV=a2=null}};